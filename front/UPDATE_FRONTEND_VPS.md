# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –Ω–∞ Ubuntu VPS

–≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –Ω–∞ –≤–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ.

## 1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–µ–∂–µ–≥–æ –∫–æ–¥–∞

–ó–∞–π–¥–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞:

```bash
cd /–ø—É—Ç—å/–∫/–ø—Ä–æ–µ–∫—Ç—É/front/client-app
# –ù–∞–ø—Ä–∏–º–µ—Ä: cd /opt/coach-flo/front/client-app
```

–ó–∞–±–µ—Ä–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ Git:

```bash
git pull origin main
# –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –¥—Ä—É–≥—É—é –≤–µ—Ç–∫—É, —É–∫–∞–∂–∏—Ç–µ –µ–µ –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, git pull origin master)
```

## 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ —Å–±–æ—Ä–∫–∞

–ï—Å–ª–∏ –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏—Ö:

```bash
npm install
```

–°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞.
**–í–∞–∂–Ω–æ:** –î–ª—è `VITE_API_URL` –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `/` –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ Nginx –ø—Ä–æ–∫—Å–∏).

```bash
npm run build
```

## 3. –î–µ–ø–ª–æ–π (–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤)

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫—É, –∫–æ—Ç–æ—Ä—É—é –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç Nginx.
–û–±—ã—á–Ω–æ —ç—Ç–æ `/var/www/coach-flo/front/dist`.

```bash
# –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —á–∏—Å—Ç–æ—Ç—ã)
sudo rm -rf /var/www/coach-flo/front/dist/*

# –ö–æ–ø–∏—Ä—É–µ–º –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã
sudo cp -r dist/* /var/www/coach-flo/front/dist/
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (–ø—Ä–∏ —á–∞—Å—Ç—ã—Ö –æ—à–∏–±–∫–∞—Ö 403)

```bash
sudo chown -R www-data:www-data /var/www/coach-flo/front
```

## 5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx (–ï—Å–ª–∏ –Ω—É–∂–Ω–æ)

‚ö†Ô∏è **–í–ê–ñ–ù–û:** –¢–∞–∫ –∫–∞–∫ –º—ã –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ API, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à —Ñ–∞–π–ª `/etc/nginx/sites-available/coach-flo` —Å–æ–¥–µ—Ä–∂–∏—Ç –±–ª–æ–∫ `location /api/`.

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```bash
sudo nano /etc/nginx/sites-available/coach-flo
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–º –µ—Å—Ç—å —ç—Ç–æ—Ç –±–ª–æ–∫:
```nginx
    location /api/ {
        proxy_pass http://localhost:8000/api/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location /uploads/ {
        proxy_pass http://localhost:8000/uploads/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
```

–ï—Å–ª–∏ –≤—ã –≤–Ω–µ—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ Nginx:

```bash
sudo nginx -t
sudo systemctl reload nginx
```

## –ë—ã—Å—Ç—Ä—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (One-Liner)

–í—ã –º–æ–∂–µ—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∫–∞–∫ `update_front.sh` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
#!/bin/bash
set -e

PROJECT_DIR="/opt/coach-flo/front/client-app"
WWW_DIR="/var/www/coach-flo/front/dist"

echo "üöÄ –ù–∞—á–∏–Ω–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞..."

cd $PROJECT_DIR
echo "üì• Git pull..."
git pull

echo "üì¶ NPM Install & Build..."
npm install
npm run build

echo "üöö –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –≤ Nginx..."
sudo rm -rf $WWW_DIR/*
sudo cp -r dist/* $WWW_DIR/

echo "‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!"
```
