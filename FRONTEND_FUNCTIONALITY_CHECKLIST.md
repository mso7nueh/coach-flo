# Чеклист функционала фронтенда Coach Fit

## ✅ Общий функционал

### Аутентификация и авторизация
- [x] Регистрация пользователей (клиенты и тренеры)
  - [x] POST /api/auth/register/step1 - создание пользователя и отправка SMS
  - [x] POST /api/auth/register/step2 - подтверждение SMS кода
- [x] Авторизация через email/пароль
  - [x] POST /api/auth/login - вход в систему
- [x] Подтверждение телефона через SMS
  - [x] POST /api/auth/send-sms - отправка SMS кода
  - [x] POST /api/auth/verify-sms - проверка SMS кода
- [x] Получение информации о текущем пользователе
  - [x] GET /api/users/me - информация о пользователе
- [x] JWT-аутентификация (все защищенные эндпоинты)

### Онбординг
- [x] Онбординг клиентов
  - [x] POST /api/onboarding/complete - завершение онбординга (создание или обновление)
  - [x] PUT /api/onboarding/ - обновление данных онбординга
  - [x] GET /api/onboarding/ - получение данных онбординга

---

## ✅ Функционал для клиентов

### Дашборд (`/dashboard`)
- [x] Статистика тренировок
  - [x] GET /api/dashboard/stats - статистика (общее количество, посещаемость, сегодня)
- [x] Отображение метрик (вес, сон, пульс, шаги)
  - [x] GET /api/metrics/body - список метрик тела
  - [x] GET /api/metrics/body/entries - записи метрик
- [x] Ближайшие и прошедшие тренировки
  - [x] GET /api/workouts - список тренировок с фильтрацией по датам
- [x] Заметки от тренера
  - [x] GET /api/notes - получение заметок
- [x] Ограничения и особенности (из онбординга)
- [x] Фото прогресса (пока только UI, без бэкенда)

### Календарь тренировок (`/calendar`)
- [x] Просмотр расписания тренировок
  - [x] GET /api/workouts - получение тренировок с фильтрацией по датам
- [x] Создание тренировок
  - [x] POST /api/workouts - создание тренировки
- [x] Редактирование тренировок
  - [x] PUT /api/workouts/{workout_id} - обновление тренировки
- [x] Удаление тренировок
  - [x] DELETE /api/workouts/{workout_id} - удаление тренировки
- [x] Повторяющиеся тренировки (ежедневно, еженедельно, ежемесячно)
  - [x] POST /api/workouts - поддержка recurrence в создании
- [x] Отметка посещаемости (запланировано, выполнено, пропущено)
  - [x] PUT /api/workouts/{workout_id} - обновление attendance
- [x] Фильтрация по формату (онлайн/офлайн)
  - [x] GET /api/workouts - фильтрация через query параметры

### Программы тренировок (`/program`)
- [x] Просмотр программ от тренера
  - [x] GET /api/programs - список программ
  - [x] GET /api/programs/{program_id} - получение программы
  - [x] GET /api/programs/{program_id}/days - дни программы
- [x] Создание собственных программ
  - [x] POST /api/programs - создание программы
  - [x] POST /api/programs/{program_id}/days - создание дня программы
- [x] Структура программы: дни тренировок с блоками (разминка, основная часть, заминка)
  - [x] Модели и схемы поддерживают блоки и упражнения
- [x] Упражнения с параметрами (подходы, повторения, вес, отдых, длительность)
  - [x] Модели поддерживают все параметры
- [x] Привязка тренировок к дням программы
  - [x] Workout.program_day_id поддерживается

### Метрики (`/metrics`)
- [x] Отслеживание показателей тела (вес, жировая масса, мышечная масса, обхваты)
  - [x] POST /api/metrics/body - создание метрики
  - [x] GET /api/metrics/body - список метрик
  - [x] POST /api/metrics/body/entries - добавление записи
  - [x] GET /api/metrics/body/entries - получение записей с фильтрацией
- [x] Отслеживание показателей упражнений (вес, повторения, подходы)
  - [x] POST /api/metrics/exercise - создание метрики упражнения
  - [x] GET /api/metrics/exercise - список метрик упражнений
  - [x] POST /api/metrics/exercise/entries - добавление записи
  - [x] GET /api/metrics/exercise/entries - получение записей с фильтрацией
- [x] Графики динамики показателей (фронтенд)
- [x] Установка целей по метрикам (фронтенд, данные в метриках)
- [x] Периоды анализа (1 неделя, 4 недели, 12 недель, все время) (фронтенд фильтрация)

### Питание (`/nutrition`)
- [x] Ведение дневника питания
  - [x] POST /api/nutrition/ - создание/обновление записи питания
  - [x] GET /api/nutrition/ - список записей с фильтрацией по датам
- [x] Учет калорий, белков, жиров, углеводов
  - [x] Модель NutritionEntry поддерживает все поля
- [x] Заметки по питанию
  - [x] Поле notes в модели

### Профиль (`/profile`, `/profile/edit`)
- [x] Редактирование личных данных
  - [x] PUT /api/users/me - обновление профиля пользователя
- [x] Просмотр информации о тренере
  - [x] GET /api/users/me - возвращает информацию о тренере через связь
- [x] Связь с тренером по коду
  - [x] POST /api/users/link-trainer - связать клиента с тренером
  - [x] POST /api/users/unlink-trainer - отвязать клиента от тренера
- [x] Настройки аккаунта (`/settings`)
  - [x] GET /api/users/me/settings - получение настроек
  - [x] PUT /api/users/me/settings - обновление настроек (локаль, уведомления)

---

## ✅ Функционал для тренеров

### Управление клиентами (`/trainer/clients`)
- [x] Список всех клиентов
  - [x] GET /api/clients - список клиентов с поиском
- [x] Добавление новых клиентов
  - [x] POST /api/clients - добавление клиента тренером
- [x] Редактирование данных клиентов (метрики, цели, ограничения)
  - [x] PUT /api/clients/{client_id} - обновление данных клиента (включая онбординг)
- [x] Просмотр статистики по клиентам
  - [x] GET /api/clients/{client_id}/stats - статистика клиента
- [x] Просмотр онбординга клиента
  - [x] GET /api/clients/{client_id}/onboarding - данные онбординга клиента
- [x] Статусы клиентов (активный/неактивный)
  - [x] User.is_active поддерживается, обновляется через PUT /api/clients/{client_id}
- [x] Пакеты тренировок с датой окончания
  - [x] User.workouts_package и package_expiry_date поддерживаются
- [x] Формат работы (онлайн/офлайн/оба)
  - [x] User.client_format поддерживается

### Календарь команды (`/trainer/calendar`)
- [x] Просмотр всех тренировок всех клиентов
  - [x] GET /api/workouts?trainer_view=true - просмотр всех тренировок команды
  - [x] GET /api/workouts?client_id={client_id} - тренировки конкретного клиента
- [x] Создание тренировок для клиентов
  - [x] POST /api/workouts - создание с указанием user_id или trainer_id (ID клиента)
- [x] Управление расписанием
  - [x] PUT /api/workouts/{workout_id} - обновление (тренер может обновлять тренировки клиентов)
  - [x] DELETE /api/workouts/{workout_id} - удаление (тренер может удалять тренировки клиентов)
- [x] Доступность тренера для записи
  - [ ] Эндпоинт для управления доступностью - **НИЗКИЙ ПРИОРИТЕТ** (можно добавить позже)

### Просмотр данных клиентов
- [x] Дашборд клиента (`/trainer/clients/:clientId`)
  - [x] GET /api/clients/{client_id} - информация о клиенте
  - [x] GET /api/clients/{client_id}/stats - статистика
  - [x] GET /api/clients/{client_id}/onboarding - данные онбординга
- [x] Метрики клиента (`/trainer/clients/:clientId/metrics`)
  - [x] GET /api/metrics/body?user_id={client_id} - метрики тела клиента
  - [x] GET /api/metrics/body/entries?user_id={client_id} - записи метрик тела
  - [x] GET /api/metrics/exercise?user_id={client_id} - метрики упражнений клиента
  - [x] GET /api/metrics/exercise/entries?user_id={client_id} - записи метрик упражнений
- [x] Программы клиента (`/trainer/clients/:clientId/program`)
  - [x] GET /api/programs?user_id={client_id} - программы клиента
  - [x] GET /api/programs/{program_id} - просмотр программы клиента
  - [x] GET /api/programs/{program_id}/days - дни программы клиента

### Программы и библиотека (`/trainer/library`)
- [x] Создание программ тренировок
  - [x] POST /api/programs - создание программы
- [x] Библиотека упражнений
  - [x] POST /api/exercises - создание упражнения
  - [x] GET /api/exercises - список упражнений с поиском и фильтрацией
  - [x] GET /api/exercises/{exercise_id} - получение упражнения
  - [x] PUT /api/exercises/{exercise_id} - обновление упражнения
  - [x] DELETE /api/exercises/{exercise_id} - удаление упражнения
- [x] Шаблоны программ (используются программы)
- [x] Распределение программ клиентам (через создание программ для клиентов)

### Финансы (`/trainer/finances`)
- [x] Учет платежей от клиентов
  - [x] POST /api/finances - создание платежа
  - [x] GET /api/finances - список платежей с фильтрацией
- [x] Типы платежей: разовый, пакет тренировок, подписка
  - [x] PaymentType enum поддерживает все типы
- [x] Статистика по доходам
  - [x] GET /api/finances/stats - статистика (месячная выручка, средний чек, общая выручка)
- [x] Графики динамики доходов (фронтенд)
- [x] Аналитика по типам платежей (фронтенд)
- [x] Аналитика по клиентам (фронтенд)
- [x] Отслеживание оставшихся занятий в пакетах
  - [x] Payment.remaining_sessions поддерживается
- [x] Даты следующих платежей по подпискам
  - [x] Payment.next_payment_date поддерживается

### Заметки для клиентов
- [x] Создание заметок
  - [x] POST /api/notes - создание заметки
- [x] Просмотр заметок
  - [x] GET /api/notes - список заметок
  - [x] GET /api/notes/{note_id} - получение заметки
- [x] Редактирование заметок
  - [x] PUT /api/notes/{note_id} - обновление заметки
- [x] Удаление заметок
  - [x] DELETE /api/notes/{note_id} - удаление заметки

---

## ✅ Все критичные эндпоинты реализованы

### Добавленные эндпоинты
- ✅ **PUT /api/users/me** - обновление профиля пользователя
- ✅ **POST /api/clients** - добавление клиента тренером
- ✅ **PUT /api/clients/{client_id}** - обновление данных клиента (включая онбординг)
- ✅ **GET /api/clients/{client_id}/onboarding** - просмотр онбординга клиента
- ✅ **PUT /api/onboarding/** - обновление онбординга
- ✅ **GET/PUT /api/users/me/settings** - настройки пользователя (локаль, уведомления)
- ✅ **POST /api/users/link-trainer** - связь клиента с тренером по коду
- ✅ **POST /api/users/unlink-trainer** - отвязка клиента от тренера
- ✅ **GET /api/workouts?trainer_view=true** - просмотр всех тренировок команды
- ✅ **GET /api/workouts?client_id={client_id}** - тренировки конкретного клиента
- ✅ **GET /api/metrics/body?user_id={client_id}** - метрики клиента для тренера
- ✅ **GET /api/metrics/exercise?user_id={client_id}** - метрики упражнений клиента для тренера
- ✅ **GET /api/programs?user_id={client_id}** - программы клиента для тренера

### Улучшения прав доступа
- ✅ Тренер может создавать, обновлять и удалять тренировки для своих клиентов
- ✅ Тренер может просматривать программы своих клиентов
- ✅ Тренер может просматривать метрики своих клиентов
- ✅ Правильная проверка прав доступа для всех операций

### Низкий приоритет (можно добавить позже)
- [ ] **Эндпоинт для управления доступностью тренера** - расписание доступности
- [ ] **Эндпоинт для фото прогресса** - загрузка и хранение фото

---

## ✅ Итого

- **Реализовано:** 100% критичного функционала
- **Отсутствует критичный функционал:** 0 эндпоинтов ✅
- **Отсутствует желательный функционал:** 2 эндпоинта (низкий приоритет)

### Статус реализации
- ✅ **Все критичные эндпоинты реализованы**
- ✅ **Основной функционал для клиентов полностью покрыт**
- ✅ **Основной функционал для тренеров полностью покрыт**
- ✅ **Поддержка фильтрации по user_id для тренеров добавлена**
- ✅ **Правильные права доступа для всех операций**
- ✅ **Поддержка создания тренировок тренером для клиентов**
- ✅ **Поддержка обновления онбординга**
- ✅ **Поддержка настроек пользователя**
- ✅ **Поддержка связи/отвязки клиента с тренером**

### Готовность к интеграции
- ✅ **Бэкенд полностью готов к интеграции с фронтендом**
- ✅ **Все эндпоинты соответствуют флоу фронтенда**
- ✅ **Правильная обработка прав доступа для обеих ролей**
- ✅ **Поддержка всех операций CRUD для всех сущностей**

